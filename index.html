<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

    <style>
        body{
            overflow-y:hidden;
        }
        #media {
            background-color: #000000;
        }
        /* Style the button and place it in the middle of the container/image */
        #overlay-btn {
            position: absolute;
            color: white;
            font-size: 16px;
            padding: 12px 24px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            width: 75%;
            margin-left: auto;
            margin-right: auto;
            right: 0;
            left: 0;
            bottom: -5px;
            text-align: center;
        }

        #overlay-btn:hover {
            bottom: 0;
        }

        #overlay{
            background-color: #555555;
            position: absolute;
            bottom: 0;
            left: 0;
            width: 75%;
            margin-left: auto;
            margin-right: auto;
            right: 0;
            opacity: 0.95;
        }
    </style>

    <title>Hello, world!</title>
</head>
<body>
        <div id="media" style="width: 100%; height: 100vh">
            <audio id="audio" autoplay="true"></audio>
            <video id="video" autoplay="true" playsinline="true"
                   style="height: 100vh; width: 100%; margin: auto; display: flex" controls>
            </video>
        </div>

<div id="overlay" class="rounded-top">
    <div class="custom-control form-group">
        <h2>Options</h2>
    </div>
    <div class="option form-group">
        <div class="custom-control">
            <div class="form-inline">
                <input id="use-datachannel" checked="checked" type="checkbox"/>
                <label for="use-datachannel">Use datachannel</label>&nbsp;
                <select id="datachannel-parameters" class="form-control" style="width: 30%">
                    <option value='{"ordered": true}'>Ordered, reliable</option>
                    <option value='{"ordered": false, "maxRetransmits": 0}'>Unordered, no retransmissions</option>
                    <option value='{"ordered": false, "maxPacketLifetime": 500}'>Unordered, 500ms lifetime</option>
                </select>
            </div>
<form action="/image" method="POST"
      enctype="multipart/form-data" id="video_form">

  <input type="file" name="image" accept="video/mp4">
    <input type="submit" value="Submit">
</form>

        </div>
    </div>
    <div class="option form-group">
        <div class="custom-control">
            <div class="form-inline">
                <input id="use-audio" type="checkbox"/>
                <label for="use-audio">Use audio</label>&nbsp;
                <select id="audio-codec" class="form-control" style="width: 30%">
                    <option value="default" selected>Default codecs</option>
                    <option value="opus/48000/2">Opus</option>
                    <option value="PCMU/8000">PCMU</option>
                    <option value="PCMA/8000">PCMA</option>
                </select>
            </div>
        </div>
    </div>
    <div class="option form-group">
        <div class="custom-control">
            <div class="form-inline">
                <input id="use-video" checked="checked" type="checkbox"/>
                <label for="use-video">Use video</label>&nbsp;
                <select id="video-resolution" class="form-control" style="width: 30%">
                    <option value="" selected>Default resolution</option>
                    <option value="320x240">320x240</option>
                    <option value="640x480">640x480</option>
                    <option value="960x540">960x540</option>
                    <option value="1280x720">1280x720</option>
                </select>&nbsp;
                <select id="video-transform" class="form-control" style="width: 30%">
                    <option value="none" selected>No transform</option>
                    <option value="edges">Edge detection</option>
                    <option value="cartoon">Cartoon effect</option>
                    <option value="rotate">Rotate</option>
                </select>&nbsp;
                <select id="video-codec" class="form-control" style="width: 30%">
                    <option value="default" selected>Default codecs</option>
                    <option value="VP8/90000">VP8</option>
                    <option value="H264/90000">H264</option>
                </select>
            </div>
        </div>
    </div>
    <div class="option form-group">
        <div class="custom-control custom-checkbox">
            <input id="use-stun" type="checkbox" />
            <label for="use-stun">Use STUN server</label>
        </div>
    </div>

    <div class="custom-control form-group" style="text-align: center">
        <button id="start" onclick="start()" class="btn btn-info" style="width: 90%">Start</button>
        <button id="stop" style="display: none; width: 90%" onclick="stop()" class="btn btn-info">Stop</button>
    </div>

    <div class="custom-control form-group" style="text-align: center">
        <a href="#data" class="btn btn-info" data-toggle="collapse" style="width: 90%">Data</a>
    </div>

    <div class="custom-control form-group">
        <div id="data" class="collapse">
            <h2>Data channel</h2>
            <pre id="data-channel" style="height: 200px;"></pre>
        </div>
    </div>

    <div style="height: 50px"></div>

    <a href="#debug" class="btn btn-info" data-toggle="collapse" style="align: center; display: none">degubg</a>
    <div id="debug" class="collapse">
        <h2>State</h2>
        ICE gathering state: <span id="ice-gathering-state"></span>
        ICE connection state: <span id="ice-connection-state"></span>
        Signaling state: <span id="signaling-state"></span>
        <h3>Offer</h3>
        <pre id="offer-sdp"></pre>

        <h3>Answer</h3>
        <pre id="answer-sdp"></pre>
    </div>
</div>
    <a id="overlay-btn" class="btn btn-primary" style="align: center;">Optionen</a>


<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<!--<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
<script lang="text/javascript">
    $( document ).ready(function() {
        //start();
        $('#overlay-btn').hide();
        window.setInterval(function() {
            var elem = document.getElementById('data-channel');
            elem.scrollTop = elem.scrollHeight;
        }, 1000);
    });

    var optionsHidden = true;

    $('#overlay-btn').click(function() {
        $('#overlay').slideToggle();
        if(optionsHidden){
            $('#overlay-btn').text("Optionen verbergen");
            optionsHidden = false;
        } else {
            $('#overlay-btn').text("Optionen");
            optionsHidden = true
        }
    });

    $('#start').click(function() {
        $('#overlay').slideToggle();
        $('#overlay-btn').show();
    });

    $('#stop').click(function() {
        $('#start').show();
    });

</script>
<script src="client.js"></script>
</body>
</html>